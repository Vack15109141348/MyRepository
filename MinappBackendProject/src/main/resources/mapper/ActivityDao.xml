<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dhcc.dao.ActivityDao">

    <resultMap type="com.dhcc.entity.Activity" id="ActivityMap">
        <result property="actcode" column="actcode" jdbcType="INTEGER"/>
        <result property="actid" column="actid" jdbcType="INTEGER"/>
        <result property="actname" column="actname" jdbcType="VARCHAR"/>
        <result property="actcontent" column="actcontent" jdbcType="VARCHAR"/>
        <result property="actsite" column="actsite" jdbcType="VARCHAR"/>
        <result property="actbegintime" column="actbegintime" jdbcType="VARCHAR"/>
        <result property="actendtime" column="actendtime" jdbcType="VARCHAR"/>
        <result property="userid" column="userid" jdbcType="INTEGER"/>
        <result property="flag" column="flag" jdbcType="INTEGER"/>
        <result property="userclass" column="userclass" jdbcType="INTEGER"/>
        <result property="username" column="username" jdbcType="VARCHAR"/>
        <result property="gender" column="gender" jdbcType="VARCHAR"/>
    </resultMap>

    <!--查询某条活动的发布情况-->
    <select id="queryById" resultMap="ActivityMap">
        select
        actcode, actid, actname, actcontent, actsite, actbegintime, actendtime, userid, flag, userclass, username,
        gender
        from wechatproject.activity
        where actcode = #{actcode}
    </select>
    <!--查询某条活动的参与情况-->
    <select id="queryByactid" resultMap="ActivityMap">
        select
        actcode, actid, actname, actcontent, actsite, actbegintime, actendtime, userid, flag, userclass, username,
        gender
        from wechatproject.activity
        where actid = #{actid} and flag = 0
    </select>
    <!--查询某个班级发布活动的情况-->
    <select id="queryByUserClass" resultMap="ActivityMap">
        select
        actcode, actid, actname, actcontent, actsite, actbegintime, actendtime, userid, flag, userclass, username,
        gender
        from wechatproject.activity
        where userclass = #{userclass} and flag=#{flag}
    </select>
    <!--查询所有已发布的活动-->

    <!--查询某位用户已发布的活动-->
    <select id="queryByUserid" resultMap="ActivityMap">
        select
        actcode, actid, actname, actcontent, actsite, actbegintime, actendtime, userid, flag, userclass, username,
        gender
        from wechatproject.activity
        where userid = #{userid} and flag=1
    </select>
    <select id="queryAllAct" resultMap="ActivityMap">
        select
        actcode, actid, actname, actcontent, actsite, actbegintime, actendtime, userid, flag, userclass, username,
        gender
        from wechatproject.activity
        where  flag=1
    </select>
    <!--查询某位用户已参加的活动-->
    <select id="queryByUseridflag" resultMap="ActivityMap">
        select
        actcode, actid, actname, actcontent, actsite, actbegintime, actendtime, userid, flag, userclass, username,
        gender
        from wechatproject.activity
        where userid = #{userid} and flag=0
    </select>

    <!--查询指定行数据-->
    <select id="queryAllByLimit" resultMap="ActivityMap">
        select
        actcode, actid, actname, actcontent, actsite, actbegintime, actendtime, userid, flag, userclass, username,
        gender
        from wechatproject.activity
        limit #{offset}, #{limit}
    </select>


    <!--通过实体作为筛选条件查询-->
    <select id="queryAll" resultMap="ActivityMap">
        select
        actcode, actid, actname, actcontent, actsite, actbegintime, actendtime, userid, flag, userclass, username,
        gender
        from wechatproject.activity
        <where>
            <if test="actcode != null">
                and actcode = #{actcode}
            </if>
            <if test="actid != null">
                and actid = #{actid}
            </if>
            <if test="actname != null and actname != ''">
                and actname = #{actname}
            </if>
            <if test="actcontent != null and actcontent != ''">
                and actcontent = #{actcontent}
            </if>
            <if test="actsite != null and actsite != ''">
                and actsite = #{actsite}
            </if>
            <if test="actbegintime != null and actbegintime != ''">
                and actbegintime = #{actbegintime}
            </if>
            <if test="actendtime != null and actendtime != ''">
                and actendtime = #{actendtime}
            </if>
            <if test="userid != null">
                and userid = #{userid}
            </if>
            <if test="flag != null">
                and flag = #{flag}
            </if>
            <if test="userclass != null">
                and userclass = #{userclass}
            </if>
            <if test="username != null and username != ''">
                and username = #{username}
            </if>
            <if test="gender != null and gender != ''">
                and gender = #{gender}
            </if>
        </where>
    </select>

    <!--新增所有列-->
    <insert id="insert" keyProperty="actcode" useGeneratedKeys="true">
        insert into wechatproject.activity(actid, actname, actcontent, actsite, actbegintime, actendtime, userid, flag,
        userclass, username, gender)
        values (#{actid}, #{actname}, #{actcontent}, #{actsite}, #{actbegintime}, #{actendtime}, #{userid}, #{flag},
        #{userclass}, #{username}, #{gender})
    </insert>

    <!--通过主键修改数据-->
    <update id="update" >
        update wechatproject.activity
        set   actname = #{actname},
                actcontent = #{actcontent},
                actsite = #{actsite},
                actbegintime = #{actbegintime},
                actendtime = #{actendtime}
        where actcode = #{actcode}
    </update>

    <!--通过主键删除-->
    <delete id="deleteById">
        delete from wechatproject.activity where actcode = #{actcode}
    </delete>

</mapper>